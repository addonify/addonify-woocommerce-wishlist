!function(y){"use strict";y(document).ready(function(){const t=y("body"),i="addonify-wishlist",s=y("#adfy-wl-sidebar-container"),e=y("#addonify-wishlist-table");let d=0,a="",o="",n="",l="",r="";const h=t.addonifyWishlistInit(addonifyWishlistJSObject),c=(h.init(),{setWishlistData:function(){localStorage.setItem(i+"_"+addonifyWishlistJSObject.thisSiteUrl+"_product_ids",JSON.stringify(n))},setDefaultWishlist:function(){var t;return n=this.getWishlistData(),o=this.getRawWishlistData(),0===n.length&&(t=new Date,t={id:0,name:addonifyWishlistJSObject.defaultWishlistName,visibility:"private",created_at:t.getTime(),product_ids:[]},n.push(t),this.setWishlistData(n),!!this.isWishlistDataSaved())&&t},getRawWishlistData:function(){return localStorage.getItem(i+"_"+addonifyWishlistJSObject.thisSiteUrl+"_product_ids")},getWishlistData:function(){var t=this.getRawWishlistData();if(null===t)return[];let i;try{i=JSON.parse(t)}catch(t){console.log(t.message)}return Array.isArray(i)?i:[]},isWishlistDataSaved:function(){return JSON.stringify(o)!==n},addToWishlist:function(t){t=parseInt(t),n=this.getWishlistData(),o=this.getRawWishlistData();var i=this.getProducts();return i.push(t),n[0].product_ids=i,this.setWishlistData(),!!this.isWishlistDataSaved()},removeFromWishlist:function(t){t=parseInt(t),n=this.getWishlistData(),o=this.getRawWishlistData();var i=this.getProducts(),t=i.indexOf(t);return-1!==t&&i.splice(t,1),n[0].product_ids=i,this.setWishlistData(),!!this.isWishlistDataSaved()},emptyWishlist:function(){return n=this.getWishlistData(),o=this.getRawWishlistData(),n[0].product_ids=[],this.setWishlistData(),!!this.isWishlistDataSaved()},isProductInWishlist:function(t){t=parseInt(t);let i=!1;var s=this.getProducts();return i=-1!==s.indexOf(t)?s.indexOf(t):i},getProductsCount:function(){return this.getProducts().length},getProducts:function(){var t=this.getWishlistData();return void 0!==t[0]?((t=t[0].product_ids).reverse(),t):[]}});function u(){if(y(document).trigger("addonify_adding_to_wishlist",[{thisButton:l}]),!1!==c.isProductInWishlist(d))"1"===addonifyWishlistJSObject.removeAlreadyAddedProductFromWishlist?(r=l,f()):(h.displayModal(addonifyWishlistJSObject.alreadyInWishlistModal,{product_name:a}),addonifyWishlistUpdateButton("already-in-wishlist",l));else if(c.addToWishlist(d),c.isWishlistDataSaved()){let i=c.getProductsCount();y(document).trigger("addonify_added_to_wishlist",[{productID:d,itemsCount:i,thisButton:l,modalContentUpdateData:{product_name:a}}]);var t={action:addonifyWishlistJSObject.getGuestSidebarTableProductRowAction,product_id:d,nonce:addonifyWishlistJSObject.nonce};0<s.length&&(t.has_wishlist_sidebar=!0),0<e.length&&(t.has_wishlist_table=!0),y.post(addonifyWishlistJSObject.ajaxURL,t).done(function(t){t.success?(t.hasOwnProperty("sidebarProductRowContent")&&h.addWishlistSidebarProductRow(t.sidebarProductRowContent),t.hasOwnProperty("tableProductRowContent")&&h.addWishlistTableProductRow(t.tableProductRowContent),h.updateWishlistSidebarElements(i)):h.displayModal(addonifyWishlistJSObject.errorModal,{error_message:t.message})})}else h.displayModal(addonifyWishlistJSObject.errorModal,{error_message:addonifyWishlistJSObject.errorAddingProductToWishlistModalMessage,product_name:a});h.hideLoader()}function f(){var t;y(document).trigger("addonify_removing_from_wishlist",[{thisButton:r}]),!1!==c.isProductInWishlist(d)?(c.removeFromWishlist(d),c.isWishlistDataSaved()?(t=c.getProductsCount(),y(document).trigger("addonify_removed_from_wishlist",[{productID:d,productName:a,itemsCount:t,thisButton:r,modalContentUpdateData:{product_name:a}}])):h.displayModal(addonifyWishlistJSObject.errorModal,{error_message:addonifyWishlistJSObject.errorRemovingProductFromWishlistModalMessage,product_name:a})):(h.displayModal(addonifyWishlistJSObject.alreadyInWishlistModal,{product_name:a}),addonifyWishlistUpdateButton("already-in-wishlist",r)),h.hideLoader()}function W(t){d=t.data("product_id"),a=t.data("product_name")}({init:function(){var t,i;null===c.getRawWishlistData()&&c.setDefaultWishlist(),"1"!==addonifyWishlistJSObject.requireLogin&&"1"!==addonifyWishlistJSObject.enabledMultiWishlist&&(c.getProducts().forEach(function(t,i){t=y('.adfy-wl-btn[data-product_id="'+t+'"]');h.updateWishlistButtons(t,"already-in-wishlist")}),"1"!==addonifyWishlistJSObject.enabledMultiWishlist)&&(h.displayLoader(),t=c.getProducts(),i=c.getProductsCount(),(0<s.length||0<e.length)&&(t={action:addonifyWishlistJSObject.getGuestWishlistContent,product_ids:JSON.stringify(t),nonce:addonifyWishlistJSObject.nonce},0<s.length&&(t.has_wishlist_sidebar=!0),0<e.length&&(t.has_wishlist_table=!0),y.post(addonifyWishlistJSObject.ajaxURL,t).done(function(t){t.success?(t.hasOwnProperty("sidebarContent")&&0<y("#adfy-wl-sidebar-items").length&&y("#adfy-wl-sidebar-items").html(t.sidebarContent),t.hasOwnProperty("tableContent")&&0<y("#adfy-wl-content").length&&y("#adfy-wl-content").html(t.tableContent)):h.displayModal(addonifyWishlistJSObject.errorModal,{error_message:t.message})}),h.updateWishlistSidebarElements(i),h.updateWishlistTableElements(i)),h.hideLoader()),this.onAddToWishlist(),this.onRemoveFromWishlist(),this.addedToCartEventHandler(),this.undoEventsHandler()},onAddToWishlist:function(){"1"!==addonifyWishlistJSObject.enabledMultiWishlist&&t.on("click",".adfy-wl-ajax-add-to-wishlist, .adfy-wl-add-to-wishlist",function(t){t.preventDefault(),"1"===addonifyWishlistJSObject.isLoginRequired?"show_popup"===addonifyWishlistJSObject.ifNotLoginAction?h.displayModal(addonifyWishlistJSObject.loginRequiredModal):window.location.href=addonifyWishlistJSObject.loginURL:addonifyWishlistJSObject.hasOwnProperty("enabledAWP")||((l=y(this)).addClass("loading"),W(l),l.hasClass("added-to-wishlist")?"1"===addonifyWishlistJSObject.removeAlreadyAddedProductFromWishlist?(r=l,f()):h.displayModal(addonifyWishlistJSObject.alreadyInWishlistModal):u(),l.removeClass("loading"))})},onRemoveFromWishlist:function(){"1"!==addonifyWishlistJSObject.enabledMultiWishlist&&(y(document).on("click",".addonify-wishlist-ajax-remove-from-wishlist, .addonify-wishlist-remove-from-wishlist",function(t){t.preventDefault(),W(r=y(this)),f()}),y(document).on("click","#addonify-wishlist__clear-all",function(t){t.preventDefault(),h.displayModal(addonifyWishlistJSObject.confirmClearWishlistModal)}),y(document).on("click","#adfy-wl-modal-confirm-clear-wl-btn",function(t){t.preventDefault(),h.displayLoader(),c.emptyWishlist()?(y(document).trigger("addonify_wishlist_emptied"),h.displayModal(addonifyWishlistJSObject.successModal,{success_message:addonifyWishlistJSObject.wishlistEmptiedModalMessage})):h.displayModal(addonifyWishlistJSObject.errorModal,{error_message:addonifyWishlistJSObject.errorEmptyingWishlistModalMessage}),h.hideLoader()}))},undoEventsHandler:function(){"1"!==addonifyWishlistJSObject.enabledMultiWishlist&&t.on("click","#addonify-wishlist-undo-deleted-product-link",function(t){t.preventDefault(),l=y(this),u()})},addedToCartEventHandler:function(){"1"!==addonifyWishlistJSObject.enabledMultiWishlist&&y(document).on("added_to_cart",function(t,i,s,e){d=e.data("product_id"),"1"===addonifyWishlistJSObject.removeFromWishlistAfterAddedToCart&&!1!==c.isProductInWishlist(d)&&(W(r=e),f())})}}).init()})}(jQuery);