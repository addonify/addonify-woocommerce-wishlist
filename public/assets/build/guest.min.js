!function(t){"function"==typeof define&&define.amd?define(t):t()}((function(){"use strict";var t;(t=jQuery)(document).ready((function(){var i=t("body"),s="addonify-wishlist",e=t("#addonify-wishlist-sticky-sidebar-container"),o=t("#addonify-wishlist-table"),a=addonifyWishlistJSObject,d=a.enabledMultiWishlist,n=a.requireLogin,l=a.ajaxURL,r=a.nonce,h=a.removeAlreadyAddedProductFromWishlist,u=a.removeFromWishlistAfterAddedToCart,c=a.getGuestSidebarTableProductRowAction,f=a.getGuestWishlistContent,W=a.thisSiteUrl,m=a.isLoginRequired,g=a.ifNotLoginAction,p=a.loginURL,y=a.defaultWishlistName,w=a.successModalClasses,b=a.alertModalClasses,v=a.errorModalClasses,_=a.infoModalClasses,D=a.addedToWishlistModalIcon,M=a.removedFromWishlistModalIcon,S=a.successModalIcon,P=a.alertModalIcon,O=a.errorModalIcon,T=a.loginRequiredModalIcon,C=a.addedToWishlistModalMessage,L=a.alreadyInWishlistModalMessage,I=a.productRemovedFormWishlistModalMessage,R=a.wishlistEmptyingConfirmationModalMessage,B=a.wishlistEmptiedModalMessage,j=a.errorEmptyingWishlistModalMessage,J=a.loginRequiredModalMessage,A=a.errorAddingProductToWishlistModalMessage,F=a.errorRemovingProductFromWishlistModalMessage,E=a.wishlistLinkModalButton,N=a.loginLinkModalButton,U=a.emptyWishlistConfirmModalButton,k=0,x="",q="",H="",G="",Q="",z="",K="",V="",X="",Y={loader:addonifyWishlistJSObject.loader,wishlistPageURL:addonifyWishlistJSObject.wishlistPageURL,saveForLaterButtonLabel:addonifyWishlistJSObject.saveForLaterButtonLabel,savedForLaterButtonLabel:addonifyWishlistJSObject.savedForLaterButtonLabel,initialAddToWishlistButtonLabel:addonifyWishlistJSObject.initialAddToWishlistButtonLabel,addedToWishlistButtonLabel:addonifyWishlistJSObject.addedToWishlistButtonLabel,alreadyInWishlistButtonLabel:addonifyWishlistJSObject.alreadyInWishlistButtonLabel,addToWishlistButtonIcon:addonifyWishlistJSObject.addToWishlistButtonIcon,addedToWishlistButtonIcon:addonifyWishlistJSObject.addedToWishlistButtonIcon,loadingWishlistButtonIcon:addonifyWishlistJSObject.loadingWishlistButtonIcon,undoNoticeTimeout:addonifyWishlistJSObject.undoNoticeTimeout,addedToWishlistModal:addonifyWishlistJSObject.addedToWishlistModal,removedFromWishlistModal:addonifyWishlistJSObject.removedFromWishlistModal,afterAddToWishlistAction:addonifyWishlistJSObject.afterAddToWishlistAction,productRemovalUndoNotice:addonifyWishlistJSObject.productRemovalUndoNotice,modalTemplate:addonifyWishlistJSObject.modalTemplate},Z=i.addonifyWishlistInit(Y);Z.init();var $={setWishlistData:function(){localStorage.setItem(s+"_"+W+"_product_ids",JSON.stringify(H))},setDefaultWishlist:function(){if(H=this.getWishlistData(),q=this.getRawWishlistData(),0===H.length){var t=new Date,i={id:0,name:y,visibility:"private",created_at:t.getTime(),product_ids:[]};return H.push(i),this.setWishlistData(H),!!this.isWishlistDataSaved()&&i}return!1},getRawWishlistData:function(){return localStorage.getItem(s+"_"+W+"_product_ids")},getWishlistData:function(){var t,i=this.getRawWishlistData();if(null===i)return[];try{t=JSON.parse(i)}catch(t){console.log(t.message)}return Array.isArray(t)?t:[]},isWishlistDataSaved:function(){return JSON.stringify(q)!==H},addToWishlist:function(t){t=parseInt(t),H=this.getWishlistData(),q=this.getRawWishlistData();var i=this.getProducts();return i.push(t),H[0].product_ids=i,this.setWishlistData(),!!this.isWishlistDataSaved()},removeFromWishlist:function(t){t=parseInt(t),H=this.getWishlistData(),q=this.getRawWishlistData();var i=this.getProducts(),s=i.indexOf(t);return-1!==s&&i.splice(s,1),H[0].product_ids=i,this.setWishlistData(),!!this.isWishlistDataSaved()},emptyWishlist:function(){return H=this.getWishlistData(),q=this.getRawWishlistData(),H[0].product_ids=[],this.setWishlistData(),!!this.isWishlistDataSaved()},isProductInWishlist:function(t){t=parseInt(t);var i=!1,s=this.getProducts();return-1!==s.indexOf(t)&&(i=s.indexOf(t)),i},getProductsCount:function(){return this.getProducts().length},getProducts:function(){var t=this.getWishlistData();if(void 0!==t[0]){var i=t[0].product_ids;return i.reverse(),i}return[]}};function tt(){if(t(document).trigger("addonify_adding_to_wishlist",[{thisButton:G}]),!1!==$.isProductInWishlist(k))"1"===h?(Q=G,it()):(at(w,D,L,E),addonifyWishlistUpdateButton("already-in-wishlist",G));else if($.addToWishlist(k),$.isWishlistDataSaved()){var i=$.getProductsCount();X=w,K=C,z=D,V=E,t(document).trigger("addonify_added_to_wishlist",[{productID:k,itemsCount:i,thisButton:G,modalContentUpdateData:et()}]),ot();var s={action:c,product_id:k,nonce:r};e.length>0&&(s.has_wishlist_sidebar=!0),o.length>0&&(s.has_wishlist_table=!0),t.post(l,s).done((function(t){t.success?(t.hasOwnProperty("sidebarProductRowContent")&&Z.addWishlistSidebarProductRow(t.sidebarProductRowContent),t.hasOwnProperty("tableProductRowContent")&&Z.addWishlistTableProductRow(t.tableProductRowContent),Z.updateWishlistSidebarElements(i)):at(v,O,t.message)}))}else at(v,O,A);Z.hideLoader()}function it(){if(t(document).trigger("addonify_removing_from_wishlist",[{thisButton:Q}]),!1!==$.isProductInWishlist(k))if($.removeFromWishlist(k),$.isWishlistDataSaved()){var i=$.getProductsCount();X=w,K=I,z=M,t(document).trigger("addonify_removed_from_wishlist",[{productID:k,productName:x,itemsCount:i,thisButton:Q,modalContentUpdateData:et()}]),ot()}else at(v,O,F);else at(w,D,L,E),addonifyWishlistUpdateButton("already-in-wishlist",Q);Z.hideLoader()}function st(t){k=t.data("product_id"),x=t.data("product_name")}function et(){return{modal_icon:z,modal_message:K,modal_button:V,modal_container_classes:X,product_name:x}}function ot(){V="",z="",X="",K=""}function at(t,i,s){X=t,z=i,K=s,V=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",Z.displayModal(et()),ot()}({init:function(){null===$.getRawWishlistData()&&$.setDefaultWishlist(),"1"!==n&&"1"!==d&&($.getProducts().forEach((function(i,s){var e=t('.adfy-wishlist-btn[data-product_id="'+i+'"]');Z.updateWishlistButtons(e,"already-in-wishlist")})),"1"!==d&&function(){Z.displayLoader();var i=$.getProducts(),s=$.getProductsCount();if(e.length>0||o.length>0){var a={action:f,product_ids:JSON.stringify(i),nonce:r};e.length>0&&(a.has_wishlist_sidebar=!0),o.length>0&&(a.has_wishlist_table=!0),t.post(l,a).done((function(i){i.success?(i.hasOwnProperty("sidebarContent")&&t("#addonify-wishlist-sidebar-items-wrapper").length>0&&t("#addonify-wishlist-sidebar-items-wrapper").html(i.sidebarContent),i.hasOwnProperty("tableContent")&&t("#addonify-wishlist-page-items-wrapper").length>0&&t("#addonify-wishlist-page-items-wrapper").html(i.tableContent)):at(v,O,i.message)})),Z.updateWishlistSidebarElements(s),Z.updateWishlistTableElements(s)}Z.hideLoader()}()),this.onAddToWishlist(),this.onRemoveFromWishlist(),this.addedToCartEventHandler(),this.undoEventsHandler()},onAddToWishlist:function(){"1"!==d&&i.on("click",".addonify-wishlist-ajax-add-to-wishlist, .addonify-add-to-wishlist-btn",(function(i){i.preventDefault(),"1"!==m?addonifyWishlistJSObject.hasOwnProperty("enabledAWP")||((G=t(this)).addClass("loading"),st(G),G.hasClass("added-to-wishlist")?"1"===h?(Q=G,it()):at(w,D,L,E):tt(),G.removeClass("loading")):"show_popup"===g?at(_,T,J,N):window.location.href=p}))},onRemoveFromWishlist:function(){"1"!==d&&(t(document).on("click",".addonify-wishlist-ajax-remove-from-wishlist, .addonify-wishlist-remove-from-wishlist",(function(i){i.preventDefault(),st(Q=t(this)),it()})),t(document).on("click","#addonify-wishlist__clear-all",(function(t){t.preventDefault(),at(b,P,R,U)})),t(document).on("click","#adfy-empty-wishlist-confirm-button",(function(i){i.preventDefault(),Z.displayLoader(),$.emptyWishlist()?(t(document).trigger("addonify_wishlist_emptied"),at(w,S,B)):at(v,O,j),Z.hideLoader()})))},undoEventsHandler:function(){"1"!==d&&i.on("click","#addonify-wishlist-undo-deleted-product-link",(function(i){i.preventDefault(),G=t(this),tt()}))},addedToCartEventHandler:function(){"1"!==d&&t(document).on("added_to_cart",(function(t,i,s,e){k=e.data("product_id"),"1"===u&&!1!==$.isProductInWishlist(k)&&(Q=e,st(e),it())}))}}).init()}))}));
